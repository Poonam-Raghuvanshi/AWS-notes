<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>VPC</title>
    <link rel="stylesheet" href="../style.css">
</head>

<body>
    <p class="main-heading"> Virtual Private Cloud </p>
    <p> <b>A VPC spans all of the Availability Zones in the Region.</b> After you create a VPC, you can add one or more
        subnets in each Availability Zone.</p>

    <p class="heading">VPC CIDR blocks</p>
    <p>
    <ul>
        <li> The CIDR block must not overlap with any existing CIDR block that's associated with the VPC.</li>
        <li>You cannot increase or decrease the size of an existing CIDR block.</li>
        <li> VPC peering connection is active - add CIDR blocks to a VPC provided they do not overlap with a CIDR block
            of the peer VPC.</li>
        <li>VPC peering connection is pending-acceptance, the owner of the requester VPC cannot add any CIDR
            block to the VPC, regardless of whether it overlaps with the CIDR block of the accepter VPC. Either the
            owner of the accepter VPC must accept the peering connection, or the owner of the requester VPC must delete
            the VPC peering connection request, add the CIDR block, and then request a new VPC peering connection.</li>
        <li> VPC peering connection is pending-acceptance, the owner of the accepter VPC can add CIDR blocks to
            the VPC. If a secondary CIDR block overlaps with a CIDR block of the requester VPC, the VPC peering
            connection request fails and cannot be accepted.</li>
    </ul>
    </p>
    <p class="heading">Subnet</p>
    <p>
        A subnet is a range of IP addresses in your VPC. <b>Each subnet must reside entirely within one Availability
            Zone and cannot span zones. </b>
        <br />

        <span class="point">Public subnet:</span> Traffic is routed to the public internet through an<b> internet
            gateway or an egress-only
            internet gateway. </b>
        <br />
        <span class="point">Private subnet:</span> Access to the public internet requires a <b> NAT device</b>.
        <br />
        <span class="point">VPN-only subnet:</span> The subnet traffic is routed to a <b> Site-to-Site VPN connection
            through a virtual private
            gateway</b>.
    </p>
    <img src="../images/vpc.PNG" />
    <p class="heading">Network ACLs</p>
    <p>
        <b> A network access control list (ACL) allows or denies specific inbound or outbound traffic at the subnet
            level. A limit of 200 NACL per VPC</b>


        <br><b> Each subnet in your VPC must be associated with a network ACL. If you don't explicitly associate a
            subnet with a
            network ACL, the subnet is automatically associated with the default network ACL.</b> <br>

        A network ACL with multiple subnets. However, a subnet with only one network ACL at a time, the previous
        association is removed.
        <br>
        We evaluate the rules in order, starting with the lowest numbered rule, when deciding whether allow or deny
        traffic. If the traffic matches a rule, the rule is applied and we do not evaluate any
        additional rules.

        We evaluate the network ACL rules when traffic enters and leaves the subnet, not as it is routed within a
        subnet.

        Network ACLs are stateless, which means that responses to allowed inbound traffic are subject to the rules for
        outbound traffic (and vice versa).

    </p>
    <img src="../images/nacl.PNG" />

    <p class="heading"> VPC Reachability Analyzer </p>
    <p> Configuration analysis tool that enables you to perform connectivity testing between a source resource and a
        destination resource in your virtual private clouds (VPCs). When the destination is reachable, Reachability
        Analyzer produces hop-by-hop details of the virtual network path between the source and the destination. When
        the destination is not reachable, Reachability Analyzer identifies the blocking component. </p>
    <p> For example, paths can be blocked by configuration
        issues in a security group, network ACL, route table, or load balancer.</p>
    <p class="heading"> NAT instance </p>
    <p>A NAT instance or a NAT Gateway can be used in a public subnet in your VPC to enable instances in the private
        subnet to initiate outbound IPv4 traffic to the Internet.</p>
    <p>NAT instance can be used as a bastion server

        Security Groups can be associated with a NAT instance

        NAT instance supports port forwarding</p>
    <p class="heading"> NAT Gateway </p>
    <p>
    <p>We always need to keep NAT&nbsp;gateway on public Subnet only, because it needs to communicate the
        Internet.&nbsp;<br>
        <br>
        AWS&nbsp;says that "To create a NAT gateway, you must specify the public subnet in which the NAT gateway should
        reside. You must also specify an&nbsp;<a
            href="https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-eips.html">Elastic IP address</a>&nbsp;to
        associate with the NAT gateway when you create it.
    </p>
    </p>

    <p class="heading"> AWS PrivateLink </p>
    <p>

        AWS PrivateLink simplifies the security of data shared with cloud-based applications by eliminating the exposure
        of data to the public Internet. AWS PrivateLink provides private connectivity between VPCs, AWS services, and
        on-premises applications, securely on the Amazon network. AWS PrivateLink makes it easy to connect services
        across different accounts and VPCs to significantly simplify the network architecture.</p>

    <p class="heading"> Transit gateway </p>
    <p>A transit gateway is a network transit hub that you can use to interconnect your virtual private clouds (VPCs)
        and on-premises networks. As your cloud infrastructure expands globally, inter-Region peering connects transit
        gateways together using the AWS Global Infrastructure. <b>Your data is automatically encrypted and never travels
            over the public internet</b>.</p>
    <p class="heading"> VPC Flow Logs </p>
    <p>A flow log captures information about the IP traffic going to and from network interfaces in your VPC.</p>
    <p class="heading"> Internet Gateway </p>
    <p>Horizontally scaled, redundant, and highly
        available VPC component that allows communication between instances in your <b>VPC and the internet</b> . It,
        therefore, imposes no availability risks or bandwidth constraints on your network traffic. </p>
    <p class="heading"> AWS Site-to-Site VPN </p>
    <p>
        Enables you to securely connect your <b> on-premises network site to your Amazon VPC </b>. A VPC VPN Connection
        utilizes IPSec to establish encrypted network connectivity between your intranet and Amazon VPC over the
        Internet. VPN Connections can be configured in minutes and are a good solution if you have an immediate need,
        have low to modest bandwidth requirements, and can tolerate the inherent variability in Internet-based
        connectivity. </p>
    <p class="heading"> Network Address Translation (NAT) instance</p>
    <p>
        Network address translation (NAT) instance in a public subnet in your VPC to enable instances in
        the private subnet to initiate outbound IPv4 traffic to the Internet or other AWS services, but prevent the
        instances from receiving inbound traffic initiated by someone on the Internet. Amazon provides Amazon Linux AMIs
        that are configured to run as NAT instances. These AMIs include the string amzn-ami-vpc-nat in their names, so
        you can search for them in the Amazon EC2 console. NAT instances are used to
        provide internet access to any instances in a private subnet.</p>
    <p class="heading"> Egress-only internet gateway</p>
    <p>Horizontally scaled, redundant, and highly available VPC component that
        allows outbound communication over IPv6 from instances in your VPC to the internet, and prevents the internet
        from initiating an IPv6 connection with your instances.</p>
    <p class="heading"> VPC peering</p>
    <p> <b>Connection between two VPCs that enables you to route traffic between them using private IPv4 addresses or
            IPv6 addresses</b>. Transitive Peering does not work for VPC peering connections (VPC peering connection
        between VPC A - VPC B , and VPC A - VPC C. Then, there is no VPC peering connection between
        VPC B and VPC C) Instead of using VPC peering, you can use an AWS Transit Gateway that acts as a network transit
        hub, to interconnect your VPCs or connect your VPCs with on-premises networks.</p>
    <p class="heading"> VPC Endpoints</p>
    <p class="point"> Interface Endpoints</p>
    <p>
        Elastic Network Interface with a private IP address from the IP address range of your subnet that serves as an
        entry point for traffic destined to a supported service. Interface endpoints extend the functionality of gateway
        endpoints by using private IP addresses to
        route requests to Amazon S3 from within your VPC, on premises, or from a VPC in another AWS Region using VPC
        peering or AWS Transit Gateway.</p>
    <p class="point"> Gateway Endpoint</p>
    <p>You specify as a target for a route in your route table for traffic
        destined to a supported AWS service. The following AWS services are supported: Amazon S3 and DynamoDB.

        You can use two types of VPC endpoints to access Amazon S3: gateway endpoints and interface endpoints. A gateway
        endpoint is a gateway that you specify in your route table to access Amazon S3 from your VPC over the AWS
        network.

        You must remember that these two services use a VPC gateway endpoint. The rest of the AWS services use VPC
        interface endpoints.</p>
    <p class="point"> VPC endpoints for Amazon SQS</p>
    <p>Use VPC endpoints, for VPC-SQS without using public IPs, and without needing to traverse the public internet. are
        <b> powered by AWS PrivateLink</b> , a highly available, scalable technology that enables
        you to privately connect your VPC to supported AWS services.

        Amazon VPC endpoints are easy to configure. They also provide reliable connectivity to Amazon SQS without
        requiring an internet gateway, Network Address Translation (NAT) instance, VPN connection, or AWS Direct Connect
        connection. With VPC endpoints, the data between your Amazon VPC and Amazon SQS queue is transferred within the
        Amazon network, helping protect your instances from internet traffic.
    </p>
    <p class="heading"> Amazon VPC console wizard</p>
    <p>

        <span class="point"> VPC with a single public subnet</span> -
        Virtual private cloud (VPC) + single public subnet + internet gateway to enable communication over the internet.
        RECOMMENDATION- If you need to run a single-tier, public-facing web application, such as a blog or a simple
        website.
    </p>
    <p>

        <span class="point"> VPC with public and private subnets (NAT) </span>- Virtual private cloud (VPC) + public
        subnet + a private subnet. RECOMMENDATION- if you want to run a public-facing
        web application while maintaining back-end servers that aren't publicly accessible. A common example is a
        multi-tier website, with the web servers in a public subnet and the database servers in a private subnet. You
        can set up security and routing so that the web servers can communicate with the database servers.
    </p>
    <p>

        <span class="point"> VPC with public and private subnets and AWS Site-to-Site VPN access</span> - Virtual
        private cloud (VPC)+ a public subnet and a private subnet, and a virtual private gateway
        to enable communication with your network over an IPsec VPN tunnel. RECOMMENDATION- if you want to
        extend your network into the cloud and also directly access the Internet from your VPC. This scenario enables
        you to run a multi-tiered application with a scalable web front end in a public subnet and to house your data in
        a private subnet that is connected to your network by an IPsec AWS Site-to-Site VPN connection.
    </p>
    <p>

        <span class="point"> VPC with a private subnet only and AWS Site-to-Site VPN access</span> - Virtual private
        cloud (VPC) + a single private subnet, and a virtual private gateway to enable communication
        with your network over an IPsec VPN tunnel. RECOMMENDATION- if you want to extend your network into the cloud
        using Amazon's infrastructure without exposing your network to the Internet.
    </p>
    <p class="heading"> VPC sharing</p>
    <p> <b> It (part of Resource Access Manager) allows multiple AWS accounts to create their application resources
            such as EC2 instances, RDS databases, Redshift clusters, and Lambda functions, into shared and
            centrally-managed Amazon Virtual Private Clouds (VPCs). VPC (owner)
            shares one or more subnets with other accounts (participants) that belong to the same organization from AWS
            Organizations.</b>
        <br />
        After a subnet is shared, the participants can view, create, modify, and delete their application
        resources in the subnets shared with them. Participants cannot view, modify, or delete resources that belong to
        other participants or the VPC owner.

        You can share Amazon VPCs to leverage the implicit routing within a VPC for applications that require a high
        degree of interconnectivity and are within the same trust boundaries. This reduces the number of VPCs that you
        create and manage while using separate accounts for billing and access control.
    </p>
    <p class="heading"> VPN CloudHub</p>
    <p>

        If you have multiple AWS Site-to-Site VPN connections, you can provide secure communication between sites using
        the AWS VPN CloudHub. This enables your remote sites to communicate with each other, and not just with the VPC.
        Sites that use AWS Direct Connect connections to the virtual private gateway can also be part of the AWS VPN
        CloudHub. The VPN CloudHub operates on a simple hub-and-spoke model that you can use with or without a VPC. This
        design is suitable if you have multiple branch offices and existing internet connections and would like to
        implement a convenient, potentially low-cost hub-and-spoke model for primary or backup connectivity between
        these remote offices.

        Per the given use-case, the corporate headquarters has an AWS Direct Connect connection to the VPC and the
        branch offices have Site-to-Site VPN connections to the VPC. Therefore using the AWS VPN CloudHub, branch
        offices can send and receive data with each other as well as with their corporate headquarters.</p>

    <p> <span class="point">Virtual private gateway</span>: A Virtual Private Gateway (also known as a VPN Gateway) is
        the endpoint on the AWS VPC side of your VPN connection.

        <span class="point">VPN connection</span>: A secure connection between your on-premises equipment and your VPCs.

        <span class="point">VPN tunnel</span> : An encrypted link where data can pass from the customer network to or
        from AWS.

        <span class="point">Customer Gateway</span> : An AWS resource that provides information to AWS about your
        Customer Gateway device.

        <span class="point">Customer Gateway device</span> : A physical device or software application on the customer
        side of the Site-to-Site VPN connection.
    </p>
    <p>
        A private hosted zone is a container for records for a domain that you host in one or more Amazon virtual
        private clouds (VPCs). You create a hosted zone for a domain (such as example.com), and then you create records
        to tell Amazon Route 53 how you want traffic to be routed for that domain within and among your VPCs.
        For each VPC that you want to associate with the Route 53 hosted zone, change the following VPC settings to
        true:
        enableDnsHostnames
        enableDnsSupport
    </p>
    <p>You should create public NAT gateway in the public subnet of each AZ and must associate an elastic IP address
        with the NAT gateway at creation. Then, you can route traffic from the NAT gateway to the internet gateway for
        the VPC.</p>
    <p>DNS hostnames and DNS resolution are required settings for private hosted zones. DNS queries for private hosted
        zones can be resolved by the Amazon-provided VPC DNS server only. As a result, these options must be enabled for
        your private hosted zone to work.f</p>
    <p>An AWS Site-to-Site VPN has a maximum throughput of 1.25 Gbps. To scale throughput beyond 1.25
        Gbps, equal-cost multi-path (ECMP) support can be used over multiple VPNs.
        AWS Transit gateway supports ECMP, but Virtual Private Gateway does not support ECMP. When
        multiple VPN links are established from on-premises to ECMP-enabled Transit Gateway, throughput
        can scale over the limit of 1.25 Gbps per tunnel. Dynamic routing using BGP must be enabled on the
        Transit Gateway for routing traffic over multiple VPN tunnels.
    </p>
    <p>
    <p>For each VPN Tunnel, AWS provides two different VPN endpoints. ECMP (Equal Cost Multi-Path) can be used to carry
        traffic on both VPN endpoints, increasing performance &amp; faster data transfer.</p>
    </p>
    <p>
    <div>
        <p><strong>Correct Answer:&nbsp;A</strong></p>

        <p>AWS reserves 5 IP addresses.</p>

        <p>The first four IP addresses and the last IP address in each subnet CIDR block are not available for you to
            use, and cannot be assigned to an instance. For example, in a subnet with CIDR block 10.0.0.0/24, the
            following five IP addresses are reserved:</p>

        <p><em>10.0.0.0: Network address.</em></p>

        <p><em>10.0.0.1: Reserved by AWS for the VPC router.</em></p>

        <p><em>10.0.0.2: Reserved by AWS. </em>The IP address of the DNS server is the base of the VPC network range
            plus two. For VPCs with multiple CIDR blocks, the IP address of the DNS server is located in the primary
            CIDR. We also reserve the base of each subnet range plus two for all CIDR blocks in the VPC. For more
            information, see the Amazon DNS server.</p>

        <p><em>10.0.0.3: Reserved by AWS for future use.</em></p>

        <p><em>10.0.0.255: Network broadcast address. </em>We do not support broadcast in a VPC, therefore we reserve
            this address.</p>

        <p>The formula to calculate the number of assignable IP addresses to CIDR networks is similar to classful
            networking. Subtract the number of network bits from 32. For example, a /24 network has 2^(32-24) - 2
            addresses available for host assignment.</p>

        <p><strong>A</strong>.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Prefix Length is
            ‘27’</p>

        <p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Therefore 32-27 = 5 and 2 ^ 5 (i.e 2 * 2 * 2 *
            2 * 2) – 5 = 27</p>

        <p><strong>B</strong>.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Prefix Length is
            ‘28’</p>

        <p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Therefore 32-28 = 4 and 2 ^ 4 (i.e 2 * 2 * 2 *
            2) - 5= 11</p>

        <p><strong>C</strong>.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Prefix Length is
            ‘29’</p>

        <p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Therefore 32-29 = 3 and 2 ^ 3 (i.e 2 * 2 * 2) -
            5&nbsp;= 3</p>

        <p><strong>D</strong>.&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Prefix Length is
            ‘30’</p>

        <p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Therefore 32-30 = 2 and 2 ^ 2 (i.e 2 * 2) - 5 =
            -1 &nbsp;</p>

        <p><strong>For option ‘A’,</strong> we get ‘27’ IP addresses (or indirectly the number of instances to be
            provisioned) as shown above.</p>

        <p>Since the user has to provision ‘20’ EC2 instances, we need&nbsp;to go with option ‘<strong>A</strong>’,
            which is the only correct IPv4 CIDR block.</p>

        <p><strong>Option B&nbsp;is incorrect </strong>because we get only ‘11’ IP addresses (or indirectly the number
            of instances to be provisioned ).</p>

        <p><strong>Option C&nbsp;is incorrect </strong>because we get only ‘3’ IP addresses.</p>

        <p><strong>Option D&nbsp;is incorrect </strong>because we get only ‘-1’ IP address.</p>

        <p>For more information, please refer to the below URL-</p>

        <ul>
            <li><a
                    href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Subnets.html#vpc-sizing-ipv4">https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Subnets.html#vpc-sizing-ipv4</a>
            </li>
        </ul>
    </div>
    </p>
</body>

</html>